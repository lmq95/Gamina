<div class="container py-3 px-sm-0">
  <div class="row">
    <div class="col-md-3 mx-auto">
      <%= render 'users/info', user: @user %>
    </div>
    
    <div class="col-md-8 offset-md-1 pt-3">
      
      <% unless @user.id == current_user.id %>
        <% if current_user.following?(@user) && @user.following?(current_user) %>
        <% if @is_room == true %>
          <%= link_to "message", room_path(@room_id), class: 'btn-sm btn-primary' %>
        <% else %>
          <%= form_with model: @room, url: rooms_path, local: true do |f| %>
            <%= fields_for @entry do |e| %>
              <%= e.hidden_field :user_id, value: @user.id %>
            <% end %>
            <%= f.submit "start message", class: 'btn-sm btn-success' %>
          <% end %>
        <% end %>
        <% end %>
      <% end %>
      
      <table class="table table-hover table-inverse">
        <thead>
          <tr>
            <th></th>
            <th>title</th>
            <th>review</th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @posts.each do |post| %>
            <tr>
              <td><%= attachment_image_tag post.user, :profile_image, :fill, 40, 40, fallback: "no-image-icon.png", class: "rounded-circle" %></td>
              <td><%= link_to post.title, post_path(post.id) %></td>
              <td>
              <div id="star-rate-<%= post.id %>"></div>
              <script>
                $('#star-rate-<%= post.id %>').raty({
                  size: 36,
                  starOff: "<%= asset_path('star/off-star.gif') %>",
                  starOn: "<%= asset_path('star/on-star.gif') %>",
                  starHalf: "<%= asset_path('star/half-star.gif') %>",
                  half: true,
                  readOnly: true,
                  score: <%= post.rate %>,
                });
              </script>
            </td>
              <td>comments: <%= post.post_comments.count %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>  
</div>